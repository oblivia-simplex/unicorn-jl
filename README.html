<!DOCTYPE html>
            <html lang="en">
            <head>
                <meta name="viewport" content="width=device-width" />
                <title>⚡ Pluto.jl ⚡</title>
                <meta charset="utf-8" />

                <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.12.4/frontend/editor.css" type="text/css" />
                <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.12.4/frontend/treeview.css" type="text/css" />
                <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.12.4/frontend/hide-ui.css" type="text/css" />
                <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/codemirror@5.57.0/lib/codemirror.min.css" type="text/css" />

                <script src="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.12.4/frontend/treeview.js"></script>

                <style id="MJX-SVG-styles">
mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"] > svg a {
  fill: blue;
  stroke: blue;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > g > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}
</style>
            </head>
            <body>
                <main><preamble><button class="runallchanged" title="Save and run all changed cells"><span></span></button></preamble><pluto-notebook id="d3b89d98-124f-11eb-2754-27c517592296"><pluto-cell class="code_folded " id="c604c88c-1236-11eb-230c-652ef7f6e877"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="" mime="text/html"><assignee></assignee><div><div class="markdown"><h1>Using the Unicorn Emulator</h1>
</div></div></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">9.1&nbsp;μs</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="code_folded " id="7fd189dc-124e-11eb-1f89-57d0dad3c20c"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="" mime="text/html"><assignee></assignee><div><div class="markdown"><p>This package supplies a Julia wrapper for the <a href="http://unicorn-engine.org">Unicorn Emulation Library</a>. To get started with the library, simply import it with </p>
<pre><code>Pkg.add(url="https://github.com/oblivia-simplex/unicorn-jl")</code></pre>
<p>and then, in the REPL, enter</p>
</div></div></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">10.8&nbsp;μs</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="" id="7acfdcc2-124e-11eb-37b3-0d6df96ff3ba"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="" mime="text/plain"><assignee></assignee><div></div></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4.98358px; left: 33.9876px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -10px; border-right-width: 40px; min-height: 23px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 3.99224px; top: 0px; height: 15.4331px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">using</span> <span class="cm-variable">Unicorn</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 40px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="height: 63px; left: 0.00460815px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">664&nbsp;ms</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="code_folded " id="a81adbee-1237-11eb-3b17-e7b19eca3f6c"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="" mime="text/html"><assignee></assignee><div><div class="markdown"><p>An emulator can be initialized by passing an <code>Arch.t</code> and a <code>Mode.t</code> variant to the <code>Emulator</code> constructor, like so:</p>
</div></div></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">7&nbsp;μs</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="" id="94cb2ac8-1237-11eb-1103-9105aee682db"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="inline_output " mime="application/vnd.pluto.tree+xml"><assignee>emu</assignee><div><jltree class="collapsed" onclick="onjltreeclick(this, event)">Emulator<jlstruct><r><k>arch</k><v><pre>X86::t = 4</pre></v></r><r><k>mode</k><v><pre>MODE_64::t = 8</pre></v></r><r><k>handle</k><v><jltree class="collapsed" onclick="onjltreeclick(this, event)">Base.RefValue{Ptr{Nothing}}<jlstruct><r><k>x</k><v><pre>Ptr{Nothing} @0x0000000003681e20</pre></v></r></jlstruct></jltree></v></r><r><k>hooks</k><v><jltree class="collapsed" onclick="onjltreeclick(this, event)">UInt64<jlarray></jlarray></jltree></v></r><r><k>array_backed_memory</k><v><jltree class="collapsed" onclick="onjltreeclick(this, event)">Dict<jldict></jldict></jltree></v></r></jlstruct></jltree></div></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4.98358px; left: 33.9876px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -10px; border-right-width: 40px; min-height: 23px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 3.99224px; top: 0px; height: 15.4331px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">emu</span> <span class="cm-operator">=</span> <span class="cm-builtin">Emulator</span>(<span class="cm-variable">Arch</span><span class="cm-operator">.</span><span class="cm-variable">X86</span>, <span class="cm-variable">Mode</span><span class="cm-operator">.</span><span class="cm-variable">MODE_64</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 40px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="height: 63px; left: 0.00460815px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">111&nbsp;ms</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="code_folded " id="efe04b04-124a-11eb-2ebd-59e517550c84"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="" mime="text/html"><assignee></assignee><div><div class="markdown"><h2>Mapping and Preparing Memory</h2>
</div></div></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">6.1&nbsp;μs</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="code_folded " id="3f8525de-1238-11eb-3fb1-8f58db34efe0"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="" mime="text/html"><assignee></assignee><div><div class="markdown"><p>The next step is typically to map a region of memory to the emulator. This can be done in one of two ways: we may provide the emulator with <code>address</code>, <code>perms</code> and <code>size</code> parameters, and let it allocate the memory itself, or we may pre-allocate an array, and pass it to the emulator. This second option allows us to reuse the same memory across numerous emulators (which we can do safely enough so long as the memory is marked as read-only), and retain direct access to that region of memory.</p>
<p>Note that emulator mapped memory <em>must</em> be page-aligned (i.e., evenly divisible by 0x1000).</p>
</div></div></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">10.5&nbsp;μs</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="" id="ae47a758-1238-11eb-2e96-bd13b350077a"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="inline_output " mime="application/vnd.pluto.tree+xml"><assignee></assignee><div><jltree class="collapsed" onclick="onjltreeclick(this, event)"><jlarray class="Tuple"><r><k>1</k><v><jltree class="collapsed" onclick="onjltreeclick(this, event)">UInt8<jlarray><r><k>1</k><v><pre>0x00</pre></v></r><r><k>2</k><v><pre>0x00</pre></v></r><r><k>3</k><v><pre>0x00</pre></v></r><r><k>4</k><v><pre>0x00</pre></v></r><r><k>5</k><v><pre>0x00</pre></v></r><r><k>6</k><v><pre>0x00</pre></v></r><r><k>7</k><v><pre>0x00</pre></v></r><r><k>8</k><v><pre>0x00</pre></v></r><r><k>9</k><v><pre>0x00</pre></v></r><r><k>10</k><v><pre>0x00</pre></v></r><r><k>11</k><v><pre>0x00</pre></v></r><r><k>12</k><v><pre>0x00</pre></v></r><r><k>13</k><v><pre>0x00</pre></v></r><r><k>14</k><v><pre>0x00</pre></v></r><r><k>15</k><v><pre>0x00</pre></v></r><r><k>16</k><v><pre>0x00</pre></v></r><r><k>17</k><v><pre>0x00</pre></v></r><r><k>18</k><v><pre>0x00</pre></v></r><r><k>19</k><v><pre>0x00</pre></v></r><r><k>20</k><v><pre>0x00</pre></v></r><r><k>21</k><v><pre>0x00</pre></v></r><r><k>22</k><v><pre>0x00</pre></v></r><r><k>23</k><v><pre>0x00</pre></v></r><r><k>24</k><v><pre>0x00</pre></v></r><r><k>25</k><v><pre>0x00</pre></v></r><r><k>26</k><v><pre>0x00</pre></v></r><r><k>27</k><v><pre>0x00</pre></v></r><r><k>28</k><v><pre>0x00</pre></v></r><r><k>29</k><v><pre>0x00</pre></v></r><r><k>30</k><v><pre>0x00</pre></v></r><r><k>31</k><v><pre>0x00</pre></v></r><r><k>32</k><v><pre>0x00</pre></v></r><r><k>33</k><v><pre>0x00</pre></v></r><r><k>34</k><v><pre>0x00</pre></v></r><r><k>35</k><v><pre>0x00</pre></v></r><r><k>36</k><v><pre>0x00</pre></v></r><r><k>37</k><v><pre>0x00</pre></v></r><r><k>38</k><v><pre>0x00</pre></v></r><r><k>39</k><v><pre>0x00</pre></v></r><r><k>40</k><v><pre>0x00</pre></v></r><r><more></more></r><r><k>8183</k><v><pre>0x00</pre></v></r><r><k>8184</k><v><pre>0x00</pre></v></r><r><k>8185</k><v><pre>0x00</pre></v></r><r><k>8186</k><v><pre>0x00</pre></v></r><r><k>8187</k><v><pre>0x00</pre></v></r><r><k>8188</k><v><pre>0x00</pre></v></r><r><k>8189</k><v><pre>0x00</pre></v></r><r><k>8190</k><v><pre>0x00</pre></v></r><r><k>8191</k><v><pre>0x00</pre></v></r><r><k>8192</k><v><pre>0x00</pre></v></r></jlarray></jltree></v></r><r><k>2</k><v><jltree class="collapsed" onclick="onjltreeclick(this, event)">UInt8<jlarray><r><k>1</k><v><pre>0x00</pre></v></r><r><k>2</k><v><pre>0x00</pre></v></r><r><k>3</k><v><pre>0x00</pre></v></r><r><k>4</k><v><pre>0x00</pre></v></r><r><k>5</k><v><pre>0x00</pre></v></r><r><k>6</k><v><pre>0x00</pre></v></r><r><k>7</k><v><pre>0x00</pre></v></r><r><k>8</k><v><pre>0x00</pre></v></r><r><k>9</k><v><pre>0x00</pre></v></r><r><k>10</k><v><pre>0x00</pre></v></r><r><k>11</k><v><pre>0x00</pre></v></r><r><k>12</k><v><pre>0x00</pre></v></r><r><k>13</k><v><pre>0x00</pre></v></r><r><k>14</k><v><pre>0x00</pre></v></r><r><k>15</k><v><pre>0x00</pre></v></r><r><k>16</k><v><pre>0x00</pre></v></r><r><k>17</k><v><pre>0x00</pre></v></r><r><k>18</k><v><pre>0x00</pre></v></r><r><k>19</k><v><pre>0x00</pre></v></r><r><k>20</k><v><pre>0x00</pre></v></r><r><k>21</k><v><pre>0x00</pre></v></r><r><k>22</k><v><pre>0x00</pre></v></r><r><k>23</k><v><pre>0x00</pre></v></r><r><k>24</k><v><pre>0x00</pre></v></r><r><k>25</k><v><pre>0x00</pre></v></r><r><k>26</k><v><pre>0x00</pre></v></r><r><k>27</k><v><pre>0x00</pre></v></r><r><k>28</k><v><pre>0x00</pre></v></r><r><k>29</k><v><pre>0x00</pre></v></r><r><k>30</k><v><pre>0x00</pre></v></r><r><k>31</k><v><pre>0x00</pre></v></r><r><k>32</k><v><pre>0x00</pre></v></r><r><k>33</k><v><pre>0x00</pre></v></r><r><k>34</k><v><pre>0x00</pre></v></r><r><k>35</k><v><pre>0x00</pre></v></r><r><k>36</k><v><pre>0x00</pre></v></r><r><k>37</k><v><pre>0x00</pre></v></r><r><k>38</k><v><pre>0x00</pre></v></r><r><k>39</k><v><pre>0x00</pre></v></r><r><k>40</k><v><pre>0x00</pre></v></r><r><more></more></r><r><k>4087</k><v><pre>0x00</pre></v></r><r><k>4088</k><v><pre>0x00</pre></v></r><r><k>4089</k><v><pre>0x00</pre></v></r><r><k>4090</k><v><pre>0x00</pre></v></r><r><k>4091</k><v><pre>0x00</pre></v></r><r><k>4092</k><v><pre>0x00</pre></v></r><r><k>4093</k><v><pre>0x00</pre></v></r><r><k>4094</k><v><pre>0x00</pre></v></r><r><k>4095</k><v><pre>0x00</pre></v></r><r><k>4096</k><v><pre>0x00</pre></v></r></jlarray></jltree></v></r></jlarray></jltree></div></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4.98358px; left: 33.9876px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -10px; border-right-width: 40px; min-height: 23px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 3.99224px; top: 0px; height: 15.4331px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">text_memory</span>, <span class="cm-variable">stack_memory</span> <span class="cm-operator">=</span> <span class="cm-builtin">fill</span>(<span class="cm-number">0x00</span>, <span class="cm-number">0x2000</span>), <span class="cm-builtin">fill</span>(<span class="cm-number">0x00</span>, <span class="cm-number">0x1000</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 40px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="height: 63px; left: 0.00460815px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">15.9&nbsp;ms</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="" id="1ae6694e-1239-11eb-3456-e192b83a369a"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="inline_output " mime="application/vnd.pluto.tree+xml"><assignee></assignee><div><jltree class="collapsed" onclick="onjltreeclick(this, event)">UInt8<jlarray><r><k>1</k><v><pre>0x00</pre></v></r><r><k>2</k><v><pre>0x00</pre></v></r><r><k>3</k><v><pre>0x00</pre></v></r><r><k>4</k><v><pre>0x00</pre></v></r><r><k>5</k><v><pre>0x00</pre></v></r><r><k>6</k><v><pre>0x00</pre></v></r><r><k>7</k><v><pre>0x00</pre></v></r><r><k>8</k><v><pre>0x00</pre></v></r><r><k>9</k><v><pre>0x00</pre></v></r><r><k>10</k><v><pre>0x00</pre></v></r><r><k>11</k><v><pre>0x00</pre></v></r><r><k>12</k><v><pre>0x00</pre></v></r><r><k>13</k><v><pre>0x00</pre></v></r><r><k>14</k><v><pre>0x00</pre></v></r><r><k>15</k><v><pre>0x00</pre></v></r><r><k>16</k><v><pre>0x00</pre></v></r><r><k>17</k><v><pre>0x00</pre></v></r><r><k>18</k><v><pre>0x00</pre></v></r><r><k>19</k><v><pre>0x00</pre></v></r><r><k>20</k><v><pre>0x00</pre></v></r><r><k>21</k><v><pre>0x00</pre></v></r><r><k>22</k><v><pre>0x00</pre></v></r><r><k>23</k><v><pre>0x00</pre></v></r><r><k>24</k><v><pre>0x00</pre></v></r><r><k>25</k><v><pre>0x00</pre></v></r><r><k>26</k><v><pre>0x00</pre></v></r><r><k>27</k><v><pre>0x00</pre></v></r><r><k>28</k><v><pre>0x00</pre></v></r><r><k>29</k><v><pre>0x00</pre></v></r><r><k>30</k><v><pre>0x00</pre></v></r><r><k>31</k><v><pre>0x00</pre></v></r><r><k>32</k><v><pre>0x00</pre></v></r><r><k>33</k><v><pre>0x00</pre></v></r><r><k>34</k><v><pre>0x00</pre></v></r><r><k>35</k><v><pre>0x00</pre></v></r><r><k>36</k><v><pre>0x00</pre></v></r><r><k>37</k><v><pre>0x00</pre></v></r><r><k>38</k><v><pre>0x00</pre></v></r><r><k>39</k><v><pre>0x00</pre></v></r><r><k>40</k><v><pre>0x00</pre></v></r><r><more></more></r><r><k>8183</k><v><pre>0x00</pre></v></r><r><k>8184</k><v><pre>0x00</pre></v></r><r><k>8185</k><v><pre>0x00</pre></v></r><r><k>8186</k><v><pre>0x00</pre></v></r><r><k>8187</k><v><pre>0x00</pre></v></r><r><k>8188</k><v><pre>0x00</pre></v></r><r><k>8189</k><v><pre>0x00</pre></v></r><r><k>8190</k><v><pre>0x00</pre></v></r><r><k>8191</k><v><pre>0x00</pre></v></r><r><k>8192</k><v><pre>0x00</pre></v></r></jlarray></jltree></div></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4.98364px; left: 33.9876px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -10px; border-right-width: 40px; min-height: 23px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>9</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 3.99224px; top: 0px; height: 15.4331px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">try</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">Unicorn</span><span class="cm-operator">.</span><span class="cm-builtin">mem_map_array</span>(<span class="cm-variable">emu</span>, <span class="cm-variable">address</span> <span class="cm-operator">=</span> <span class="cm-number">0x1000</span>, <span class="cm-variable">size</span> <span class="cm-operator">=</span> <span class="cm-number">0x2000</span>, <span class="cm-variable">perms</span> <span class="cm-operator">=</span> <span class="cm-variable">Perm</span><span class="cm-operator">.</span><span class="cm-variable">READ</span> <span class="cm-operator">|</span> <span class="cm-variable">Perm</span><span class="cm-operator">.</span><span class="cm-variable">WRITE</span> <span class="cm-operator">|</span> <span class="cm-variable">Perm</span><span class="cm-operator">.</span><span class="cm-variable">EXEC</span>, <span class="cm-variable">array</span> <span class="cm-operator">=</span> <span class="cm-variable">text_memory</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">catch</span> <span class="cm-variable">e</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">if</span> <span class="cm-variable">e</span> <span class="cm-operator">==</span> <span class="cm-variable">Unicorn</span><span class="cm-operator">.</span><span class="cm-builtin">UcException</span>(<span class="cm-variable">Unicorn</span><span class="cm-operator">.</span><span class="cm-variable">UcError</span><span class="cm-operator">.</span><span class="cm-variable">MAP</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-string">md"This method will throw an $e exception if run more than once in a row with the same parameters. This is because the emulator will refuse to map a region that has already been mapped."</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">else</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-builtin">throw</span>(<span class="cm-variable">e</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">end</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">end</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 40px; width: 1px; border-bottom: 0px solid transparent; top: 193px;"></div><div class="CodeMirror-gutters" style="height: 233px; left: 0.00460815px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">107&nbsp;ms</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="" id="f6abd068-123c-11eb-39ef-6741c9490212"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="inline_output " mime="application/vnd.pluto.tree+xml"><assignee></assignee><div><jltree class="collapsed" onclick="onjltreeclick(this, event)">UInt8<jlarray><r><k>1</k><v><pre>0x00</pre></v></r><r><k>2</k><v><pre>0x00</pre></v></r><r><k>3</k><v><pre>0x00</pre></v></r><r><k>4</k><v><pre>0x00</pre></v></r><r><k>5</k><v><pre>0x00</pre></v></r><r><k>6</k><v><pre>0x00</pre></v></r><r><k>7</k><v><pre>0x00</pre></v></r><r><k>8</k><v><pre>0x00</pre></v></r><r><k>9</k><v><pre>0x00</pre></v></r><r><k>10</k><v><pre>0x00</pre></v></r><r><k>11</k><v><pre>0x00</pre></v></r><r><k>12</k><v><pre>0x00</pre></v></r><r><k>13</k><v><pre>0x00</pre></v></r><r><k>14</k><v><pre>0x00</pre></v></r><r><k>15</k><v><pre>0x00</pre></v></r><r><k>16</k><v><pre>0x00</pre></v></r><r><k>17</k><v><pre>0x00</pre></v></r><r><k>18</k><v><pre>0x00</pre></v></r><r><k>19</k><v><pre>0x00</pre></v></r><r><k>20</k><v><pre>0x00</pre></v></r><r><k>21</k><v><pre>0x00</pre></v></r><r><k>22</k><v><pre>0x00</pre></v></r><r><k>23</k><v><pre>0x00</pre></v></r><r><k>24</k><v><pre>0x00</pre></v></r><r><k>25</k><v><pre>0x00</pre></v></r><r><k>26</k><v><pre>0x00</pre></v></r><r><k>27</k><v><pre>0x00</pre></v></r><r><k>28</k><v><pre>0x00</pre></v></r><r><k>29</k><v><pre>0x00</pre></v></r><r><k>30</k><v><pre>0x00</pre></v></r><r><k>31</k><v><pre>0x00</pre></v></r><r><k>32</k><v><pre>0x00</pre></v></r><r><k>33</k><v><pre>0x00</pre></v></r><r><k>34</k><v><pre>0x00</pre></v></r><r><k>35</k><v><pre>0x00</pre></v></r><r><k>36</k><v><pre>0x00</pre></v></r><r><k>37</k><v><pre>0x00</pre></v></r><r><k>38</k><v><pre>0x00</pre></v></r><r><k>39</k><v><pre>0x00</pre></v></r><r><k>40</k><v><pre>0x00</pre></v></r><r><more></more></r><r><k>4087</k><v><pre>0x00</pre></v></r><r><k>4088</k><v><pre>0x00</pre></v></r><r><k>4089</k><v><pre>0x00</pre></v></r><r><k>4090</k><v><pre>0x00</pre></v></r><r><k>4091</k><v><pre>0x00</pre></v></r><r><k>4092</k><v><pre>0x00</pre></v></r><r><k>4093</k><v><pre>0x00</pre></v></r><r><k>4094</k><v><pre>0x00</pre></v></r><r><k>4095</k><v><pre>0x00</pre></v></r><r><k>4096</k><v><pre>0x00</pre></v></r></jlarray></jltree></div></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4.98352px; left: 33.9876px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -10px; border-right-width: 40px; min-height: 23px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>5</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 3.99224px; top: 0px; height: 15.4331px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">try</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">Unicorn</span><span class="cm-operator">.</span><span class="cm-builtin">mem_map_array</span>(<span class="cm-variable">emu</span>, <span class="cm-variable">address</span> <span class="cm-operator">=</span> <span class="cm-number">0x40_000</span>, <span class="cm-variable">size</span> <span class="cm-operator">=</span> <span class="cm-number">0x1000</span>, <span class="cm-variable">perms</span> <span class="cm-operator">=</span> <span class="cm-variable">Perm</span><span class="cm-operator">.</span><span class="cm-variable">WRITE</span> <span class="cm-operator">|</span> <span class="cm-variable">Perm</span><span class="cm-operator">.</span><span class="cm-variable">READ</span>, <span class="cm-variable">array</span> <span class="cm-operator">=</span> <span class="cm-variable">stack_memory</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">catch</span> <span class="cm-variable">e</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-string">md"Here, we can expect to see a '$(e)' if the cell is run more than once."</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">end</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 40px; width: 1px; border-bottom: 0px solid transparent; top: 100px;"></div><div class="CodeMirror-gutters" style="height: 140px; left: 0.00460815px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">42.9&nbsp;ms</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="code_folded " id="c9506264-1239-11eb-1893-111dfdcb27f9"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="" mime="text/html"><assignee></assignee><div><div class="markdown"><p>Now let's load some code into the emulator.</p>
<pre><code>49 c7 c6 08 00 04 00      mov $0x00040000, %r14
4c 89 f4                  mov %r14, %rsp
ba ef be ad de            mov $0xcafebeef, %edx
52                        push %rdx</code></pre>
</div></div></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">5.4&nbsp;μs</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="" id="89cd300a-123d-11eb-39c4-e36a77c343da"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="inline_output " mime="application/vnd.pluto.tree+xml"><assignee>code</assignee><div><jltree class="collapsed" onclick="onjltreeclick(this, event)">UInt8<jlarray><r><k>1</k><v><pre>0x49</pre></v></r><r><k>2</k><v><pre>0xc7</pre></v></r><r><k>3</k><v><pre>0xc6</pre></v></r><r><k>4</k><v><pre>0x08</pre></v></r><r><k>5</k><v><pre>0x00</pre></v></r><r><k>6</k><v><pre>0x04</pre></v></r><r><k>7</k><v><pre>0x00</pre></v></r><r><k>8</k><v><pre>0x4c</pre></v></r><r><k>9</k><v><pre>0x89</pre></v></r><r><k>10</k><v><pre>0xf4</pre></v></r><r><k>11</k><v><pre>0xba</pre></v></r><r><k>12</k><v><pre>0xef</pre></v></r><r><k>13</k><v><pre>0xbe</pre></v></r><r><k>14</k><v><pre>0xfe</pre></v></r><r><k>15</k><v><pre>0xca</pre></v></r><r><k>16</k><v><pre>0x52</pre></v></r></jlarray></jltree></div></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4.98364px; left: 33.9876px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -10px; border-right-width: 40px; min-height: 23px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>6</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 3.99224px; top: 0px; height: 15.4331px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">code</span> <span class="cm-operator">=</span> [</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">0x49</span>, <span class="cm-number">0xc7</span>, <span class="cm-number">0xc6</span>, <span class="cm-number">0x08</span>, <span class="cm-number">0x00</span>, <span class="cm-number">0x04</span>, <span class="cm-number">0x00</span>,</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">0x4c</span>, <span class="cm-number">0x89</span>, <span class="cm-number">0xf4</span>,</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">0xba</span>, <span class="cm-number">0xef</span>, <span class="cm-number">0xbe</span>, <span class="cm-number">0xfe</span>, <span class="cm-number">0xca</span>,</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">0x52</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">]</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 40px; width: 1px; border-bottom: 0px solid transparent; top: 100px;"></div><div class="CodeMirror-gutters" style="height: 140px; left: 0.00460815px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">16.2&nbsp;ms</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="" id="adec2540-123d-11eb-0670-43225377f55d"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="" mime="text/plain"><assignee></assignee><div></div></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4.98364px; left: 33.9876px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -10px; border-right-width: 40px; min-height: 23px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 3.99224px; top: 0px; height: 15.4331px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">mem_write</span>(<span class="cm-variable">emu</span>, <span class="cm-variable">address</span> <span class="cm-operator">=</span> <span class="cm-number">0x1000</span>, <span class="cm-variable">bytes</span> <span class="cm-operator">=</span> <span class="cm-variable">code</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 40px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="height: 63px; left: 0.00460815px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">54.8&nbsp;ms</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="code_folded " id="312648de-123f-11eb-0470-dbeb996846b0"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="" mime="text/html"><assignee></assignee><div><div class="markdown"><p>Let's check to see if <code>text_memory</code> has been written to.</p>
</div></div></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">5.4&nbsp;μs</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="" id="cb5c5c1c-123d-11eb-1984-4b6b44325dc0"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="inline_output " mime="application/vnd.pluto.tree+xml"><assignee></assignee><div><jltree class="collapsed" onclick="onjltreeclick(this, event)">UInt8<jlarray><r><k>1</k><v><pre>0x49</pre></v></r><r><k>2</k><v><pre>0xc7</pre></v></r><r><k>3</k><v><pre>0xc6</pre></v></r><r><k>4</k><v><pre>0x08</pre></v></r><r><k>5</k><v><pre>0x00</pre></v></r><r><k>6</k><v><pre>0x04</pre></v></r><r><k>7</k><v><pre>0x00</pre></v></r><r><k>8</k><v><pre>0x4c</pre></v></r><r><k>9</k><v><pre>0x89</pre></v></r><r><k>10</k><v><pre>0xf4</pre></v></r><r><k>11</k><v><pre>0xba</pre></v></r><r><k>12</k><v><pre>0xef</pre></v></r><r><k>13</k><v><pre>0xbe</pre></v></r><r><k>14</k><v><pre>0xfe</pre></v></r><r><k>15</k><v><pre>0xca</pre></v></r><r><k>16</k><v><pre>0x52</pre></v></r><r><k>17</k><v><pre>0x00</pre></v></r><r><k>18</k><v><pre>0x00</pre></v></r><r><k>19</k><v><pre>0x00</pre></v></r><r><k>20</k><v><pre>0x00</pre></v></r><r><k>21</k><v><pre>0x00</pre></v></r><r><k>22</k><v><pre>0x00</pre></v></r><r><k>23</k><v><pre>0x00</pre></v></r><r><k>24</k><v><pre>0x00</pre></v></r><r><k>25</k><v><pre>0x00</pre></v></r><r><k>26</k><v><pre>0x00</pre></v></r><r><k>27</k><v><pre>0x00</pre></v></r><r><k>28</k><v><pre>0x00</pre></v></r><r><k>29</k><v><pre>0x00</pre></v></r><r><k>30</k><v><pre>0x00</pre></v></r><r><k>31</k><v><pre>0x00</pre></v></r><r><k>32</k><v><pre>0x00</pre></v></r><r><k>33</k><v><pre>0x00</pre></v></r><r><k>34</k><v><pre>0x00</pre></v></r><r><k>35</k><v><pre>0x00</pre></v></r><r><k>36</k><v><pre>0x00</pre></v></r><r><k>37</k><v><pre>0x00</pre></v></r><r><k>38</k><v><pre>0x00</pre></v></r><r><k>39</k><v><pre>0x00</pre></v></r><r><k>40</k><v><pre>0x00</pre></v></r><r><more></more></r><r><k>8183</k><v><pre>0x00</pre></v></r><r><k>8184</k><v><pre>0x00</pre></v></r><r><k>8185</k><v><pre>0x00</pre></v></r><r><k>8186</k><v><pre>0x00</pre></v></r><r><k>8187</k><v><pre>0x00</pre></v></r><r><k>8188</k><v><pre>0x00</pre></v></r><r><k>8189</k><v><pre>0x00</pre></v></r><r><k>8190</k><v><pre>0x00</pre></v></r><r><k>8191</k><v><pre>0x00</pre></v></r><r><k>8192</k><v><pre>0x00</pre></v></r></jlarray></jltree></div></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4.98364px; left: 33.9876px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -10px; border-right-width: 40px; min-height: 23px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 3.99224px; top: 0px; height: 15.4331px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">text_memory</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 40px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="height: 63px; left: 0.00460815px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">1.7&nbsp;μs</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="code_folded " id="da11b2fa-123f-11eb-3ed2-37eef0af9065"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="" mime="text/html"><assignee></assignee><div><div class="markdown"><p>We can check the mapped memory regions at any time with <code>mem_regions()</code>.</p>
</div></div></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">5.6&nbsp;μs</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="" id="03a11fb4-1240-11eb-3f0f-25c203e32b2e"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="inline_output " mime="application/vnd.pluto.tree+xml"><assignee></assignee><div><jltree class="collapsed" onclick="onjltreeclick(this, event)">Unicorn.MemRegion<jlarray><r><k>1</k><v><jltree class="collapsed" onclick="onjltreeclick(this, event)">Unicorn.MemRegion<jlstruct><r><k>from</k><v><pre>0x0000000000001000</pre></v></r><r><k>to</k><v><pre>0x0000000000002fff</pre></v></r><r><k>perms</k><v><pre>EXEC|WRITE|READ</pre></v></r></jlstruct></jltree></v></r><r><k>2</k><v><jltree class="collapsed" onclick="onjltreeclick(this, event)">Unicorn.MemRegion<jlstruct><r><k>from</k><v><pre>0x0000000000040000</pre></v></r><r><k>to</k><v><pre>0x0000000000040fff</pre></v></r><r><k>perms</k><v><pre>WRITE|READ</pre></v></r></jlstruct></jltree></v></r></jlarray></jltree></div></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4.98364px; left: 33.9876px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -10px; border-right-width: 40px; min-height: 23px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 3.99224px; top: 0px; height: 15.4331px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">mem_regions</span>(<span class="cm-variable">emu</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 40px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="height: 63px; left: 0.00460815px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">66.8&nbsp;ms</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="code_folded " id="12d5e160-1240-11eb-20ff-17aa2dbf65e7"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="" mime="text/html"><assignee></assignee><div><div class="markdown"><h2>Hooking Callbacks into Emulation Events</h2>
<p>Much of the power of the Unicorn library comes from its ability to hook specific emulation events and call user-defined callbacks. Let's set a callback to disassemble instructions as they're executed. For this, we'll use the Capstone disassembly library, via its Python bindings, using <code>PyCall</code>.</p>
</div></div></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">6.6&nbsp;μs</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="" id="5d5bfd96-1240-11eb-2dae-5b3b1bd63a1d"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="" mime="text/plain"><assignee></assignee><div></div></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4.98364px; left: 33.9876px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -10px; border-right-width: 40px; min-height: 23px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 3.99224px; top: 0px; height: 15.4331px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">using</span> <span class="cm-variable">PyCall</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 40px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="height: 63px; left: 0.00460815px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">2.2&nbsp;s</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="" id="2f3fbeba-1243-11eb-2592-eb8c0de8f351"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="" mime="text/plain"><assignee></assignee><div></div></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4.98364px; left: 33.9876px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -10px; border-right-width: 40px; min-height: 23px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 3.99224px; top: 0px; height: 15.4331px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">using</span> <span class="cm-variable">Printf</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 40px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="height: 63px; left: 0.00460815px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">1.1&nbsp;s</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="" id="6cd718a0-1240-11eb-2ebe-55a898a6046d"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="inline_output " mime="text/plain"><assignee>capstone</assignee><div><pre><code>PyObject &lt;module 'capstone' from '/home/lucca/.conda/lib/python3.7/site-packages/capstone/__init__.py'&gt;</code></pre></div></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4.98364px; left: 33.9876px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -10px; border-right-width: 40px; min-height: 23px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 3.99224px; top: 0px; height: 15.4331px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">capstone</span> <span class="cm-operator">=</span> <span class="cm-builtin">pyimport</span>(<span class="cm-string">"capstone"</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 40px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="height: 63px; left: 0.00460815px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">361&nbsp;ms</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="" id="269dd940-1241-11eb-1514-833b022bc7ee"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="inline_output " mime="text/plain"><assignee>cs</assignee><div><pre><code>PyObject &lt;capstone.Cs object at 0x7f74e0d56a58&gt;</code></pre></div></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4.98364px; left: 33.9876px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -10px; border-right-width: 40px; min-height: 23px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 3.99224px; top: 0px; height: 15.4331px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">cs</span> <span class="cm-operator">=</span> <span class="cm-variable">capstone</span><span class="cm-operator">.</span><span class="cm-builtin">Cs</span>(<span class="cm-variable">capstone</span><span class="cm-operator">.</span><span class="cm-variable">CS_ARCH_X86</span>, <span class="cm-variable">capstone</span><span class="cm-operator">.</span><span class="cm-variable">CS_MODE_64</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 40px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="height: 63px; left: 0.00460815px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">70.7&nbsp;ms</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="code_folded " id="86e3866a-1241-11eb-31a0-73c9896dcc62"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="" mime="text/html"><assignee></assignee><div><div class="markdown"><p>The best way to get information back out of the emulator is by using closures as callbacks. Here, we're going to use a closure to push disassembly results back into the environment from which the emulation is dispatched.</p>
</div></div></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">5&nbsp;μs</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="" id="c3c24ec6-1242-11eb-1dab-376e5c0c123d"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="inline_output " mime="application/vnd.pluto.tree+xml"><assignee>disassembly</assignee><div><jltree class="collapsed" onclick="onjltreeclick(this, event)">String<jlarray></jlarray></jltree></div></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4.98364px; left: 33.9876px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -10px; border-right-width: 40px; min-height: 23px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 3.99224px; top: 0px; height: 15.4331px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">disassembly</span> <span class="cm-operator">=</span> <span class="cm-builtin">Vector</span>{<span class="cm-variable">String</span>}()</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 40px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="height: 63px; left: 0.00460815px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">2.2&nbsp;ms</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="" id="0bef5d6c-1246-11eb-2bdb-1d0577b8cf11"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="inline_output " mime="application/vnd.pluto.tree+xml"><assignee>addresses</assignee><div><jltree class="collapsed" onclick="onjltreeclick(this, event)">UInt64<jlarray></jlarray></jltree></div></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4.98364px; left: 33.9876px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -10px; border-right-width: 40px; min-height: 23px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>2</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 3.99224px; top: 0px; height: 15.4331px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">addresses</span> <span class="cm-operator">=</span> <span class="cm-builtin">Vector</span>{<span class="cm-variable">UInt64</span>}()</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 40px; width: 1px; border-bottom: 0px solid transparent; top: 39px;"></div><div class="CodeMirror-gutters" style="height: 79px; left: 0.00460815px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">2.1&nbsp;ms</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="" id="9b5a1ecc-1241-11eb-018c-85d41e8f03a2"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="inline_output " mime="text/plain"><assignee>callback</assignee><div><pre><code>(::Main.workspace140.var"#closure#1"{Array{String,1},Array{UInt64,1}}) (generic function with 1 method)</code></pre></div></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4.98364px; left: 33.9876px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -10px; border-right-width: 40px; min-height: 23px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>15</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 3.99224px; top: 0px; height: 15.4331px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">callback</span> <span class="cm-operator">=</span> </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">let</span> <span class="cm-variable">disassembly</span><span class="cm-builtin">::Vector{String}</span> <span class="cm-operator">=</span> <span class="cm-variable">disassembly</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">let</span> <span class="cm-variable">addresses</span><span class="cm-builtin">::Vector{UInt64}</span> <span class="cm-operator">=</span> <span class="cm-variable">addresses</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-builtin">sizehint!</span>(<span class="cm-variable">disassembly</span>, <span class="cm-number">1024</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-builtin">sizehint!</span>(<span class="cm-variable">addresses</span>, <span class="cm-number">1024</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">function</span> <span class="cm-def">closure</span>(<span class="cm-variable">handle</span><span class="cm-builtin">::UcHandle</span>, <span class="cm-variable">address</span><span class="cm-builtin">::UInt64</span>, <span class="cm-variable">size</span><span class="cm-builtin">::UInt32</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-builtin">push!</span>(<span class="cm-variable">addresses</span>, <span class="cm-variable">address</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">bytes</span> <span class="cm-operator">=</span> <span class="cm-builtin">mem_read</span>(<span class="cm-variable">handle</span>, <span class="cm-variable">address</span> <span class="cm-operator">=</span> <span class="cm-variable">address</span>, <span class="cm-variable">size</span> <span class="cm-operator">=</span> <span class="cm-variable">size</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">for</span> <span class="cm-variable">inst</span> <span class="cm-operator">in</span> <span class="cm-variable">cs</span><span class="cm-operator">.</span><span class="cm-builtin">disasm</span>(<span class="cm-variable">bytes</span>, <span class="cm-variable">address</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">10</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">dis</span> <span class="cm-operator">=</span> <span class="cm-meta">@sprintf</span> <span class="cm-string">"0x%x: %s, %s\n"</span> <span class="cm-variable">inst</span><span class="cm-operator">.</span><span class="cm-variable">address</span> <span class="cm-variable">inst</span><span class="cm-operator">.</span><span class="cm-variable">mnemonic</span> <span class="cm-variable">inst</span><span class="cm-operator">.</span><span class="cm-variable">op_str</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">11</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-builtin">push!</span>(<span class="cm-variable">disassembly</span>, <span class="cm-variable">dis</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">12</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">end</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">13</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">end</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">14</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">end</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">15</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">end</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 40px; width: 1px; border-bottom: 0px solid transparent; top: 239px;"></div><div class="CodeMirror-gutters" style="height: 279px; left: 0.00460815px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">7&nbsp;ms</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="code_folded " id="ae2dcc4c-124d-11eb-2ad3-81cf2159ef47"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="" mime="text/html"><assignee></assignee><div><div class="markdown"><p>Note that we need to be <em>extremely</em> careful here, or else we risk memory corruption. The size and memory layout of any data structures that will be mutated by the callback functions should be fixed before execution begins.</p>
</div></div></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">6.6&nbsp;μs</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="" id="6f0c67a8-1243-11eb-2bbd-dd9a8624ff41"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="inline_output " mime="text/plain"><assignee>hook_handle</assignee><div><pre><code>0x0000000003e2c3d0</code></pre></div></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4.98364px; left: 33.9876px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -10px; border-right-width: 40px; min-height: 23px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 3.99224px; top: 0px; height: 15.4331px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">hook_handle</span> <span class="cm-operator">=</span> <span class="cm-builtin">code_hook_add</span>(<span class="cm-variable">emu</span>, <span class="cm-variable">begin_addr</span><span class="cm-operator">=</span><span class="cm-number">0x1000</span>, <span class="cm-variable">until_addr</span><span class="cm-operator">=</span><span class="cm-number">0x2000</span>, <span class="cm-variable">callback</span><span class="cm-operator">=</span><span class="cm-variable">callback</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 40px; width: 1px; border-bottom: 0px solid transparent; top: 39px;"></div><div class="CodeMirror-gutters" style="height: 79px; left: 0.00460815px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">128&nbsp;ms</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="code_folded " id="6b51d77e-1243-11eb-337d-373da2f79e9b"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="" mime="text/html"><assignee></assignee><div><div class="markdown"><p>Now we're ready to launch the emulation.</p>
</div></div></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">5.3&nbsp;μs</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="" id="f3c05f7c-1243-11eb-38d4-cf3ff655ee21"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="inline_output " mime="text/plain"><assignee></assignee><div><pre><code>OK::t = 0</code></pre></div></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4.98364px; left: 33.9876px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -10px; border-right-width: 40px; min-height: 23px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 3.99224px; top: 0px; height: 15.4331px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">start</span>(<span class="cm-variable">emu</span>, <span class="cm-variable">begin_addr</span><span class="cm-operator">=</span><span class="cm-number">0x1000</span>, <span class="cm-variable">until_addr</span><span class="cm-operator">=</span><span class="cm-number">0x2000</span>, <span class="cm-variable">steps</span><span class="cm-operator">=</span><span class="cm-number">4</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 40px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="height: 63px; left: 0.00460815px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">91.9&nbsp;ms</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="code_folded " id="78030b16-1248-11eb-3823-f3b341e9fad2"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="" mime="text/html"><assignee></assignee><div><div class="markdown"><p>The <code>disassembly</code> vector should now contain the output of the capstone disassembler that we ran in our code hook callback. Let's take a look.</p>
</div></div></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">5.2&nbsp;μs</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="code_folded " id="0f483e54-1244-11eb-317d-93c6eb3eee43"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="" mime="text/html"><assignee></assignee><div><div class="markdown"><h3>Results of the Disassembly Trace</h3>
<pre><code>	
0x1000: mov, r14, 0x40008
0x1007: mov, rsp, r14
0x100a: mov, edx, 0xcafebeef
0x100f: push, rdx
0x1010: add, byte ptr [rax], al

	</code></pre>
</div></div></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">9.7&nbsp;ms</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="code_folded " id="fae9ecb0-124c-11eb-16be-81bcc30ed002"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="inline_output " mime="application/vnd.pluto.tree+xml"><assignee></assignee><div><jltree class="collapsed" onclick="onjltreeclick(this, event)">String<jlarray><r><k>1</k><v><pre>"0x1000: mov, r14, 0x40008\n"</pre></v></r><r><k>2</k><v><pre>"0x1007: mov, rsp, r14\n"</pre></v></r><r><k>3</k><v><pre>"0x100a: mov, edx, 0xcafebeef\n"</pre></v></r><r><k>4</k><v><pre>"0x100f: push, rdx\n"</pre></v></r><r><k>5</k><v><pre>"0x1010: add, byte ptr [rax], al\n"</pre></v></r></jlarray></jltree></div></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">1.8&nbsp;μs</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="code_folded " id="68f63150-1248-11eb-2955-6dbf52c20776"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="" mime="text/html"><assignee></assignee><div><div class="markdown"><p>And the <code>addresses</code> vector should contain all of the addresses executed by the emulator.</p>
</div></div></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">5.4&nbsp;μs</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="" id="a00ff164-1248-11eb-1162-d7fc60cb3773"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="inline_output " mime="application/vnd.pluto.tree+xml"><assignee></assignee><div><jltree class="collapsed" onclick="onjltreeclick(this, event)">UInt64<jlarray><r><k>1</k><v><pre>0x0000000000001000</pre></v></r><r><k>2</k><v><pre>0x0000000000001007</pre></v></r><r><k>3</k><v><pre>0x000000000000100a</pre></v></r><r><k>4</k><v><pre>0x000000000000100f</pre></v></r><r><k>5</k><v><pre>0x0000000000001010</pre></v></r></jlarray></jltree></div></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4.9834px; left: 33.9876px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -10px; border-right-width: 40px; min-height: 23px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 3.99224px; top: 0px; height: 15.4331px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">addresses</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 40px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="height: 63px; left: 0.00460815px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">2&nbsp;μs</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="code_folded " id="a63442aa-1248-11eb-19a3-4fb88a3fed26"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="" mime="text/html"><assignee></assignee><div><div class="markdown"><p>Finally, the <code>stack_memory</code> array should contain the word <code>0xdeadbeef</code>, which our emulated x86_64 code pushed to the stack.</p>
</div></div></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">5.4&nbsp;μs</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="" id="c120fc84-1248-11eb-33ef-7b6f9f5a4a8d"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="inline_output " mime="text/plain"><assignee></assignee><div><pre><code>0xcafebeef</code></pre></div></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4.98364px; left: 33.9876px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -10px; border-right-width: 40px; min-height: 23px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 3.99224px; top: 0px; height: 15.4331px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">reinterpret</span>(<span class="cm-variable">UInt32</span>, <span class="cm-variable">stack_memory</span>[<span class="cm-number">1</span><span class="cm-operator">:</span><span class="cm-number">4</span>])[<span class="cm-number">1</span>]</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 40px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="height: 63px; left: 0.00460815px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">46.1&nbsp;ms</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="code_folded " id="e02eff0e-1248-11eb-0953-4b2dd5ced19e"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="" mime="text/html"><assignee></assignee><div><div class="markdown"><p>Let's look at the stack pointer in our emulated CPU.</p>
</div></div></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">5.2&nbsp;μs</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="" id="eaced3ee-1248-11eb-3ac7-4f15b682768b"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="inline_output " mime="text/plain"><assignee></assignee><div><pre><code>0x0000000000040000</code></pre></div></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4.98364px; left: 33.9876px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -10px; border-right-width: 40px; min-height: 23px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 3.99224px; top: 0px; height: 15.4331px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">reg_read</span>(<span class="cm-variable">emu</span>, <span class="cm-variable">X86</span><span class="cm-operator">.</span><span class="cm-variable">Register</span><span class="cm-operator">.</span><span class="cm-variable">RSP</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 40px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="height: 63px; left: 0.00460815px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">15.8&nbsp;ms</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="code_folded " id="a0f065e2-124a-11eb-37e3-bb1589537dd7"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="" mime="text/html"><assignee></assignee><div><div class="markdown"><p>We can also read emulation memory through the Unicorn API, with the <code>mem_read()</code> method.</p>
</div></div></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">5.4&nbsp;μs</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="" id="b6004086-124a-11eb-2c09-b3192cebcbbf"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="inline_output " mime="text/plain"><assignee></assignee><div><pre><code>0xcafebeef</code></pre></div></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4.98364px; left: 33.9876px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -10px; border-right-width: 40px; min-height: 23px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 3.99224px; top: 0px; height: 15.4331px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">reinterpret</span>(<span class="cm-variable">UInt32</span>, <span class="cm-builtin">mem_read</span>(<span class="cm-variable">emu</span>, <span class="cm-variable">address</span><span class="cm-operator">=</span><span class="cm-number">0x40_000</span>, <span class="cm-variable">size</span><span class="cm-operator">=</span><span class="cm-number">4</span>))[<span class="cm-number">1</span>]</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 40px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="height: 63px; left: 0.00460815px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">52.2&nbsp;ms</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="code_folded " id="e81ea82c-124d-11eb-2c9e-591d7deebb7e"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="" mime="text/html"><assignee></assignee><div><div class="markdown"><p>Finally, we can removed the hooked callback with <code>hook_del()</code>:</p>
</div></div></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">5.2&nbsp;μs</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell><pluto-cell class="" id="e0cf5328-124d-11eb-3e7c-f7521fb9373e"><pluto-shoulder draggable="true" title="Drag to move cell"><button class="foldcode" title="Show/hide code"><span></span></button></pluto-shoulder><pluto-trafficlight></pluto-trafficlight><button class="add_cell before" title="Add cell"><span></span></button><pluto-output class="" mime="text/plain"><assignee></assignee><div></div></pluto-output><pluto-input><button class="delete_cell" title="Delete cell"><span></span></button><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4.98364px; left: 33.9876px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -10px; border-right-width: 40px; min-height: 23px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 3.99224px; top: 0px; height: 15.4331px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -29.9954px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">hook_del</span>(<span class="cm-variable">emu</span>, <span class="cm-variable">hook_handle</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 40px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="height: 63px; left: 0.00460815px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></pluto-input><pluto-runarea><button class="runcell" title="Run"><span></span></button><span class="runtime">28.5&nbsp;ms</span></pluto-runarea><button class="add_cell after" title="Add cell"><span></span></button></pluto-cell></pluto-notebook><dropruler></dropruler></main>
                <svg id="MJX-SVG-global-cache" style="display: none;"><defs></defs></svg>
            </body>
            </html>
        